# Vulnerability Disclosure Report

**Generated**: January 2025
**Tool**: AISentry Semantic Taint Analyzer
**Researcher**: [Your Name]

---

## Summary

During our research on semantic taint analysis for LLM applications, we discovered multiple security vulnerabilities in popular open-source projects. This document contains the findings for responsible disclosure.

## Vulnerabilities

### 1. SQL Injection in chatgpt-retrieval-plugin (OpenAI)

**Repository**: https://github.com/openai/chatgpt-retrieval-plugin
**Severity**: HIGH
**CWE**: CWE-89 (SQL Injection)

**Affected Files**:
- `datastore/providers/analyticdb_datastore.py` (lines 68, 85, 95, 147, 177)

**Description**:
The AnalyticDB datastore provider constructs SQL queries using f-string formatting with user-controlled embedding data. This allows SQL injection attacks.

**Vulnerable Code**:
```python
# analyticdb_datastore.py:68
sql = f"""
    SELECT id, text, metadata
    FROM {self.collection_name}
    ORDER BY embedding <-> '{embedding}'
    LIMIT {top_k}
"""
cursor.execute(sql)
```

**Impact**:
- Data exfiltration from vector database
- Modification of stored documents
- Potential RCE via database functions

**Remediation**:
Use parameterized queries:
```python
sql = """
    SELECT id, text, metadata
    FROM %s
    ORDER BY embedding <-> %s
    LIMIT %s
"""
cursor.execute(sql, (self.collection_name, embedding, top_k))
```

---

### 2. Command Injection in danswer

**Repository**: https://github.com/danswer-ai/danswer
**Severity**: CRITICAL
**CWE**: CWE-78 (OS Command Injection)

**Affected Files**:
- `backend/scripts/save_load_state.py` (lines 48, 56)

**Description**:
The deployment scripts construct shell commands with user-controlled file paths and execute them with `shell=True`.

**Vulnerable Code**:
```python
copy_cmd = f"docker cp {host_file_path} {container_name}:/tmp/"
subprocess.run(copy_cmd, shell=True, check=True)
```

**Impact**:
- Arbitrary command execution on deployment server
- Container escape potential
- Full system compromise

**Remediation**:
Use array-based subprocess calls:
```python
subprocess.run(["docker", "cp", host_file_path, f"{container_name}:/tmp/"], check=True)
```

---

### 3. Excessive Agency in AutoGPT

**Repository**: https://github.com/Significant-Gravitas/AutoGPT
**Severity**: HIGH
**CWE**: CWE-94 (Code Injection)

**Affected Files**:
- `autogpt_platform/backend/backend/executor/manager.py` (line 876)
- Multiple files in `autogpt_platform/backend/`

**Description**:
The agent framework executes LLM-generated code directly without adequate sandboxing, enabling prompt injection to achieve code execution.

**Impact**:
- Arbitrary code execution via prompt injection
- Host system compromise
- Data exfiltration

**Recommendation**:
- Implement code execution sandboxing (Docker, gVisor, Firecracker)
- Add code review/approval step before execution
- Limit available modules in execution context

---

### 4. Multiple Vulnerabilities in OpenDevin

**Repository**: https://github.com/OpenDevin/OpenDevin
**Severity**: CRITICAL
**Findings**: 678 critical, 211 high severity

**Key Issues**:
- SQL injection in data processing
- Command injection in build scripts
- Sensitive data exposure in logs

**Details**: See `vulnerability_scan_results/opendevin_scan.json`

---

### 5. SQL Injection in embedchain

**Repository**: https://github.com/embedchain/embedchain
**Severity**: HIGH
**Findings**: 406 critical, 96 high severity

**Key Issues**:
- Database query construction with f-strings
- Insufficient input validation

---

## Disclosure Timeline

| Date | Action |
|------|--------|
| 2025-01-14 | Vulnerabilities discovered |
| 2025-01-XX | Initial reports sent to maintainers |
| 2025-XX-XX | [Response received] |
| 2025-XX-XX | [Patches released] |
| 2025-XX-XX | [Public disclosure] |

## Contact

For questions about this disclosure:
- Email: [your-email]
- GitHub: [your-github]

## References

- OWASP LLM Top 10: https://owasp.org/www-project-top-10-for-large-language-model-applications/
- CWE-89: https://cwe.mitre.org/data/definitions/89.html
- CWE-78: https://cwe.mitre.org/data/definitions/78.html
- CWE-94: https://cwe.mitre.org/data/definitions/94.html
